# Riddler: Null Set - Solution

## Challenge Overview

The challenge presents a Batman-themed cryptography puzzle involving three "bombs" (large numbers) and an encrypted flag. The narrative describes finding "common veins" (shared factors) between the numbers to decrypt a hidden message.

## Given Data

From `chall.md`:
- Hospital: 17228885174970084276161970522097412605266394159971647740752267300221714788550197385293497867284890619874129427467673441688167088281496263523126626874873040420690149997429144654882986643604004320995801451651978549126665724326037323443693785147308295273804941176324595270160848031743691643352199091770561183390101638892864365971529361775777473322338259828117124021731569968581096105773133290818616623517239075045010723533051858606599891085860123293236498867687161911760308272069433482552999066140765265852927860548903142423166019118304640362315363826033542802010314992302177183041218307694787831493560402247717975058777

- Subway: 18599394198408159559032127206556973904470958589652384401139516143215782574096306554190666147629219501568720150220610776907290318953673688570966652188653414334135944107812388490123363711694776438197910528441090458287491320232545060818540405255660036329115175285563075067615115662971223964466609690121087345003072037826745412886843594744373925001833637904010490107159214131436719753440343088809862147325818389229992483097674780613975438662993160352072711897374040436210067117793225426902614028702255450993606803712362745736227617347976687372229897332444483782057154829741076097868855041890160420732593056490770604016963

- Financial: 21465018203265794097113095991538507070009934123584712754183836984749947784914875073029917205704709806063598091539183323502642805321030095506965670322592578944062438932372074147246983365306801187413681411691600283518148755726465920648688770335822658763606803297069673119665208343264880669287960265441639527802610566656299685318339460983357111370900461103556978263689008699830462732473301850828945035801211567525902267631084241059888222620103913512778392054697511670625304307246238730039519706049298726456456715325025195145205840264871637036819903723164701441937741275296892662198340153409014099281713703913671372908819

- Flag (encrypted): 2688799573415612194172688341985385655869767021669706325971969222982091539107082257386772222987306933827264001995669863266148641628566567467721627695226828529063310337313730890984773336370189319810197054705752635402192590291140330841505400796372134659065052651929114899378965182328524235056804062656407286061152078766613035623406173201907601732254045680536238007225975731741967059981506881028597601704173481437206652323544395617004541689706710800898777397919180336353911831098500922631432068656317452009839798641849451740369839351859125801709185337650226880544125158905221302154116578507914015625510759196575232097337

## Analysis

### Step 1: Identifying the Attack Vector

The challenge hints at finding "common veins" between numbers. This is a classic **RSA Common Factor Attack**, where multiple RSA moduli share prime factors, allowing complete factorization through GCD operations.

### Step 2: Factorization

Using `gcd()` to find shared factors:

```python
from math import gcd

p = gcd(Hospital, Subway)
q = gcd(Hospital, Financial)
s = gcd(Subway, Financial)
```

Results:
- **p** (shared by Hospital & Subway) = 1221834425262287319531828150230450328117606411416613080885206789556490640623576352722184729382296510215987976961317543543010405251073915605201082530365669241348374003358470908217244784702248661103303352626742944857512976412368167295709554978119108856310340435318474859197385357288546284863331891949947177502227

- **q** (shared by Hospital & Financial) = 1410083462926788476932111099714859316833764836179411189490922409994631975597348936907023074490316634433237660637165205400231099115593669787613745067893610040661140270608873110008118835461549016236864815063968943833507566644841734201095442523455806370320972153507623384794691205575604188785234703304520637436551

- **s** (shared by Subway & Financial) = 1522251609043957540903351685052702495611528510905758943800353447620962364928207388821407242101902673897345892257667176895483412762741917670754373047191827235779728592235438407253839778124192886679200399422881076948292722828126019458655308886470244554472501381871923007885038637482505268893521513630372526661969

### Step 3: Verify Factorization

```python
assert Hospital == p * q
assert Subway == p * s
assert Financial == q * s
```

All assertions pass! ✓

The factorization is:
- Hospital = p × q (256 bytes, 2048 bits)
- Subway = p × s (256 bytes, 2048 bits)
- Financial = q × s (256 bytes, 2048 bits)

### Step 4: Decryption Attempts

Multiple standard cryptographic approaches were attempted:

1. **RSA Decryption** with φ(n) = (p-1)(q-1) for each modulus
2. **RSA with Combined Modulus** n = p×q×s with φ(n) = (p-1)(q-1)(s-1)
3. **XOR-based decryption** using factors as keys
4. **Chinese Remainder Theorem** reconstruction
5. **Low-exponent attacks** (cube roots, etc.)
6. **Modular arithmetic** with flag mod p, flag mod q, flag mod s

None of these standard approaches yielded a readable plaintext flag.

## Current Status

The factorization phase is **complete and verified**. The three "bombs" have been successfully factored using GCD operations, revealing the shared prime factors p, q, and s.

The decryption phase requires further investigation. The encryption method used may be:
- A custom scheme not following standard RSA
- A multi-prime RSA variant with non-standard parameters
- A hybrid encryption combining multiple techniques
- An encoding/transformation not yet identified

## How to Run

Use the provided Python script to verify the factorization:

```bash
python3 solve_rsa.py
```

## Flag Format

The flag should be wrapped as: `ctf{...}kernel`

## Tools & Techniques

- Python 3 with math.gcd()
- RSA common factor attack
- Modular arithmetic
- Chinese Remainder Theorem
- Various decryption attempts

## References

- [RSA Common Factor Attack](https://crypto.stackexchange.com/questions/16283/how-to-use-common-modulus-attack)
- [GCD-based RSA Factorization](https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Faulty_key_generation)
- [Multi-prime RSA](https://en.wikipedia.org/wiki/RSA_(cryptosystem)#Multi-prime_RSA)
